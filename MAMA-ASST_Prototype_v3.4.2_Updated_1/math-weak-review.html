<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>취약점 복습 | 수학 | MAMA-ASST</title>
  
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
  
  <!-- KaTeX -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
  <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
  
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#FF6D4D',
            math: '#FBBC05',
            'math-light': '#FEF7E0',
            'math-dark': '#E5A800',
            background: '#F9FAFB',
            surface: '#FFFFFF',
            'border-light': '#E5E7EB',
            'text-primary': '#1F2937',
            'text-secondary': '#6B7280',
            'text-tertiary': '#9CA3AF',
            success: '#22C55E',
            'success-light': '#F0FDF4',
            error: '#EF4444',
            'error-light': '#FEF2F2',
            warning: '#F59E0B',
            'warning-light': '#FFFBEB',
          },
          fontFamily: { sans: ['Pretendard', 'Apple SD Gothic Neo', 'Malgun Gothic', 'sans-serif'] },
        },
      },
    }
  </script>
  
  <style>
    .katex { font-size: 1.1em; }
    
    @keyframes slide-up {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    .slide-up { animation: slide-up 0.3s ease-out forwards; }
    
    .card-hover { transition: all 0.2s; }
    .card-hover:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1); }
    
    .badge-direct {
      background: linear-gradient(135deg, #22C55E 0%, #16A34A 100%);
      color: white;
    }
    .badge-step {
      background: linear-gradient(135deg, #FBBC05 0%, #F59E0B 100%);
      color: #1F2937;
    }
    
    .tab-btn {
      transition: all 0.2s;
    }
    .tab-btn.active {
      background: white;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body class="bg-background font-sans text-text-primary antialiased min-h-screen">
  
  <!-- Header -->
  <header class="h-14 bg-surface border-b border-border-light flex items-center justify-between px-4 sticky top-0 z-40">
    <a href="subject-math.html" class="p-2 -ml-2 text-text-secondary hover:text-text-primary rounded-lg transition-colors">
      <span class="material-icons-round">arrow_back</span>
    </a>
    <span class="font-bold text-text-primary">취약점 복습</span>
    <a href="ai-tutor.html" class="p-2 -mr-2 text-text-secondary hover:text-text-primary rounded-lg transition-colors">
      <span class="material-icons-round">smart_toy</span>
    </a>
  </header>
  
  <main class="max-w-2xl mx-auto p-4 pb-32">
    
    <!-- Hero Banner -->
    <section class="bg-gradient-to-r from-error to-orange-400 rounded-2xl p-5 mb-6 text-white relative overflow-hidden">
      <div class="absolute -right-8 -top-8 w-28 h-28 bg-white/10 rounded-full"></div>
      <div class="flex items-center gap-4">
        <div class="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center flex-shrink-0">
          <span class="material-icons-round text-2xl">crisis_alert</span>
        </div>
        <div>
          <h1 class="text-lg font-bold">취약점 집중 복습</h1>
          <p class="text-white/80 text-sm">틀린 문제를 다시 풀고 완벽하게 이해하세요</p>
        </div>
      </div>
    </section>
    
    <!-- Weak Type Summary -->
    <section class="mb-6">
      <h2 class="font-bold text-text-primary mb-3 flex items-center gap-2">
        <span class="material-icons-round text-error text-lg">trending_down</span>
        취약 유형
      </h2>
      
      <div class="grid grid-cols-2 gap-3">
        <div class="bg-surface rounded-xl p-4 shadow-lg border border-error/30 card-hover">
          <div class="flex items-center gap-2 mb-2">
            <span class="w-8 h-8 rounded-full bg-error-light flex items-center justify-center">
              <span class="material-icons-round text-error text-lg">swap_horiz</span>
            </span>
            <div>
              <h3 class="font-bold text-error text-sm">이항 실수</h3>
            </div>
          </div>
          <div class="flex justify-between text-xs mb-1">
            <span class="text-text-secondary">정답률</span>
            <span class="font-bold text-error">45%</span>
          </div>
          <div class="w-full h-1.5 bg-error-light rounded-full">
            <div class="h-full bg-error rounded-full" style="width: 45%"></div>
          </div>
        </div>
        
        <div class="bg-surface rounded-xl p-4 shadow-lg border border-warning/30 card-hover">
          <div class="flex items-center gap-2 mb-2">
            <span class="w-8 h-8 rounded-full bg-warning-light flex items-center justify-center">
              <span class="material-icons-round text-warning text-lg">calculate</span>
            </span>
            <div>
              <h3 class="font-bold text-warning text-sm">계산 실수</h3>
            </div>
          </div>
          <div class="flex justify-between text-xs mb-1">
            <span class="text-text-secondary">정답률</span>
            <span class="font-bold text-warning">68%</span>
          </div>
          <div class="w-full h-1.5 bg-warning-light rounded-full">
            <div class="h-full bg-warning rounded-full" style="width: 68%"></div>
          </div>
        </div>
      </div>
    </section>
    
    <!-- Tab Filter -->
    <section class="mb-4">
      <div class="bg-gray-100 rounded-xl p-1 flex">
        <button onclick="filterErrors('all')" class="tab-btn flex-1 py-2 px-4 rounded-lg text-sm font-medium active" data-tab="all">
          전체 <span class="text-text-tertiary">(6)</span>
        </button>
        <button onclick="filterErrors('direct')" class="tab-btn flex-1 py-2 px-4 rounded-lg text-sm font-medium text-text-secondary" data-tab="direct">
          <span class="inline-flex items-center gap-1">
            <span class="material-icons-round text-sm text-success">bolt</span>
            바로정답 <span class="text-text-tertiary">(2)</span>
          </span>
        </button>
        <button onclick="filterErrors('step')" class="tab-btn flex-1 py-2 px-4 rounded-lg text-sm font-medium text-text-secondary" data-tab="step">
          <span class="inline-flex items-center gap-1">
            <span class="material-icons-round text-sm text-math">format_list_numbered</span>
            단계 <span class="text-text-tertiary">(4)</span>
          </span>
        </button>
      </div>
    </section>
    
    <!-- Error List -->
    <section class="space-y-4" id="errorList">
      
      <!-- Direct Answer Error 1 -->
      <div class="error-card bg-surface rounded-2xl shadow-lg border border-border-light overflow-hidden card-hover" data-type="direct">
        <div class="bg-success-light p-3 border-b border-success/20 flex items-center justify-between">
          <div class="flex items-center gap-2">
            <span class="px-2 py-0.5 badge-direct text-[10px] font-bold rounded flex items-center gap-1">
              <span class="material-icons-round text-xs">bolt</span>
              바로정답
            </span>
            <span class="w-6 h-6 rounded-full bg-error text-white flex items-center justify-center text-xs font-bold">✗</span>
            <span class="text-xs text-text-tertiary">어제</span>
          </div>
          <span class="text-xs text-error font-medium">1단계에서 시도</span>
        </div>
        
        <div class="p-4">
          <h3 class="font-bold text-text-primary mb-3">일차방정식 풀이</h3>
          
          <div class="bg-gray-50 rounded-lg p-3 mb-3">
            <p class="text-xs text-text-tertiary mb-1">문제</p>
            <div id="directEq1" class="text-lg font-bold text-text-primary"></div>
          </div>
          
          <div class="grid grid-cols-2 gap-2 mb-3">
            <div class="bg-error-light rounded-lg p-2.5 border border-error/30">
              <p class="text-[10px] text-error font-medium mb-1">내가 선택한 답</p>
              <p class="font-bold text-error">x = -2</p>
            </div>
            <div class="bg-success-light rounded-lg p-2.5 border border-success/30">
              <p class="text-[10px] text-success font-medium mb-1">정답</p>
              <p class="font-bold text-success">x = -8</p>
            </div>
          </div>
          
          <div class="bg-math-light rounded-lg p-3 mb-3">
            <p class="text-xs text-math-dark font-medium flex items-center gap-1 mb-1">
              <span class="material-icons-round text-sm">lightbulb</span>
              팁
            </p>
            <p class="text-xs text-text-secondary">이항할 때 부호가 바뀌어요: -5를 이항하면 +5가 됩니다.</p>
          </div>
          
          <button onclick="retryProblem(1)" class="w-full py-2.5 bg-error hover:bg-error/90 text-white font-bold rounded-xl transition-colors flex items-center justify-center gap-2 text-sm">
            <span class="material-icons-round text-lg">replay</span>
            다시 풀기
          </button>
        </div>
      </div>
      
      <!-- Step Error 1 -->
      <div class="error-card bg-surface rounded-2xl shadow-lg border border-border-light overflow-hidden card-hover" data-type="step">
        <div class="bg-math-light p-3 border-b border-math/20 flex items-center justify-between">
          <div class="flex items-center gap-2">
            <span class="px-2 py-0.5 badge-step text-[10px] font-bold rounded">단계풀이</span>
            <span class="w-6 h-6 rounded-full bg-warning text-gray-900 flex items-center justify-center text-xs font-bold">!</span>
            <span class="text-xs text-text-tertiary">오늘</span>
          </div>
          <span class="text-xs text-warning font-medium">1, 3단계 오류</span>
        </div>
        
        <div class="p-4">
          <h3 class="font-bold text-text-primary mb-1">일차방정식의 풀이</h3>
          <p class="text-xs text-text-tertiary mb-3">4단계 중 2단계에서 설명을 봤어요</p>
          
          <div class="bg-gray-50 rounded-lg p-3 mb-3">
            <p class="text-xs text-text-tertiary mb-1">문제</p>
            <div id="stepEq1" class="text-lg font-bold text-text-primary"></div>
          </div>
          
          <!-- Step Errors -->
          <div class="space-y-2 mb-3">
            <div class="bg-error-light rounded-lg p-3 border border-error/20">
              <div class="flex items-center gap-2 mb-2">
                <span class="w-5 h-5 rounded-full bg-error text-white flex items-center justify-center text-[10px] font-bold">1</span>
                <span class="text-xs font-bold text-error">단계 1: 방정식 정리</span>
              </div>
              <div class="grid grid-cols-2 gap-2 text-xs">
                <div>
                  <span class="text-error">내 선택:</span>
                  <span id="step1Wrong1" class="font-medium"></span>
                </div>
                <div>
                  <span class="text-success">정답:</span>
                  <span id="step1Correct1" class="font-medium"></span>
                </div>
              </div>
            </div>
            
            <div class="bg-error-light rounded-lg p-3 border border-error/20">
              <div class="flex items-center gap-2 mb-2">
                <span class="w-5 h-5 rounded-full bg-error text-white flex items-center justify-center text-[10px] font-bold">3</span>
                <span class="text-xs font-bold text-error">단계 3: 상수항 이항</span>
              </div>
              <div class="grid grid-cols-2 gap-2 text-xs">
                <div>
                  <span class="text-error">내 선택:</span>
                  <span id="step1Wrong3" class="font-medium"></span>
                </div>
                <div>
                  <span class="text-success">정답:</span>
                  <span id="step1Correct3" class="font-medium"></span>
                </div>
              </div>
            </div>
          </div>
          
          <button onclick="retryProblem(2)" class="w-full py-2.5 bg-math hover:bg-math-dark text-gray-900 font-bold rounded-xl transition-colors flex items-center justify-center gap-2 text-sm">
            <span class="material-icons-round text-lg">replay</span>
            다시 풀기
          </button>
        </div>
      </div>
      
      <!-- Direct Answer Error 2 -->
      <div class="error-card bg-surface rounded-2xl shadow-lg border border-border-light overflow-hidden card-hover" data-type="direct">
        <div class="bg-success-light p-3 border-b border-success/20 flex items-center justify-between">
          <div class="flex items-center gap-2">
            <span class="px-2 py-0.5 badge-direct text-[10px] font-bold rounded flex items-center gap-1">
              <span class="material-icons-round text-xs">bolt</span>
              바로정답
            </span>
            <span class="w-6 h-6 rounded-full bg-error text-white flex items-center justify-center text-xs font-bold">✗</span>
            <span class="text-xs text-text-tertiary">2일 전</span>
          </div>
          <span class="text-xs text-error font-medium">2단계에서 시도</span>
        </div>
        
        <div class="p-4">
          <h3 class="font-bold text-text-primary mb-3">복잡한 일차방정식</h3>
          
          <div class="bg-gray-50 rounded-lg p-3 mb-3">
            <p class="text-xs text-text-tertiary mb-1">문제</p>
            <div id="directEq2" class="text-lg font-bold text-text-primary"></div>
          </div>
          
          <div class="grid grid-cols-2 gap-2 mb-3">
            <div class="bg-error-light rounded-lg p-2.5 border border-error/30">
              <p class="text-[10px] text-error font-medium mb-1">내가 선택한 답</p>
              <p class="font-bold text-error">x = 3</p>
            </div>
            <div class="bg-success-light rounded-lg p-2.5 border border-success/30">
              <p class="text-[10px] text-success font-medium mb-1">정답</p>
              <p class="font-bold text-success">x = 7</p>
            </div>
          </div>
          
          <button onclick="retryProblem(3)" class="w-full py-2.5 bg-error hover:bg-error/90 text-white font-bold rounded-xl transition-colors flex items-center justify-center gap-2 text-sm">
            <span class="material-icons-round text-lg">replay</span>
            다시 풀기
          </button>
        </div>
      </div>
      
      <!-- Step Error 2 -->
      <div class="error-card bg-surface rounded-2xl shadow-lg border border-border-light overflow-hidden card-hover" data-type="step">
        <div class="bg-math-light p-3 border-b border-math/20 flex items-center justify-between">
          <div class="flex items-center gap-2">
            <span class="px-2 py-0.5 badge-step text-[10px] font-bold rounded">단계풀이</span>
            <span class="w-6 h-6 rounded-full bg-warning text-gray-900 flex items-center justify-center text-xs font-bold">!</span>
            <span class="text-xs text-text-tertiary">3일 전</span>
          </div>
          <span class="text-xs text-warning font-medium">4단계 오류</span>
        </div>
        
        <div class="p-4">
          <h3 class="font-bold text-text-primary mb-1">등식의 변형</h3>
          <p class="text-xs text-text-tertiary mb-3">4단계 중 1단계에서 설명을 봤어요</p>
          
          <div class="bg-gray-50 rounded-lg p-3 mb-3">
            <p class="text-xs text-text-tertiary mb-1">문제</p>
            <div id="stepEq2" class="text-lg font-bold text-text-primary"></div>
          </div>
          
          <div class="bg-error-light rounded-lg p-3 border border-error/20 mb-3">
            <div class="flex items-center gap-2 mb-2">
              <span class="w-5 h-5 rounded-full bg-error text-white flex items-center justify-center text-[10px] font-bold">4</span>
              <span class="text-xs font-bold text-error">단계 4: 최종 계산</span>
            </div>
            <div class="grid grid-cols-2 gap-2 text-xs">
              <div>
                <span class="text-error">내 선택:</span>
                <span class="font-medium">x = 6</span>
              </div>
              <div>
                <span class="text-success">정답:</span>
                <span class="font-medium">x = 7</span>
              </div>
            </div>
          </div>
          
          <button onclick="retryProblem(4)" class="w-full py-2.5 bg-math hover:bg-math-dark text-gray-900 font-bold rounded-xl transition-colors flex items-center justify-center gap-2 text-sm">
            <span class="material-icons-round text-lg">replay</span>
            다시 풀기
          </button>
        </div>
      </div>
      
      <!-- Step Error 3 -->
      <div class="error-card bg-surface rounded-2xl shadow-lg border border-border-light overflow-hidden card-hover" data-type="step">
        <div class="bg-math-light p-3 border-b border-math/20 flex items-center justify-between">
          <div class="flex items-center gap-2">
            <span class="px-2 py-0.5 badge-step text-[10px] font-bold rounded">단계풀이</span>
            <span class="w-6 h-6 rounded-full bg-warning text-gray-900 flex items-center justify-center text-xs font-bold">!</span>
            <span class="text-xs text-text-tertiary">5일 전</span>
          </div>
          <span class="text-xs text-warning font-medium">2단계 오류</span>
        </div>
        
        <div class="p-4">
          <h3 class="font-bold text-text-primary mb-1">문자와 식</h3>
          <p class="text-xs text-text-tertiary mb-3">3단계 중 1단계에서 설명을 봤어요</p>
          
          <div class="bg-gray-50 rounded-lg p-3 mb-3">
            <p class="text-xs text-text-tertiary mb-1">문제</p>
            <div id="stepEq3" class="text-lg font-bold text-text-primary"></div>
          </div>
          
          <div class="bg-error-light rounded-lg p-3 border border-error/20 mb-3">
            <div class="flex items-center gap-2 mb-2">
              <span class="w-5 h-5 rounded-full bg-error text-white flex items-center justify-center text-[10px] font-bold">2</span>
              <span class="text-xs font-bold text-error">단계 2: 동류항 정리</span>
            </div>
            <div class="grid grid-cols-2 gap-2 text-xs">
              <div>
                <span class="text-error">내 선택:</span>
                <span class="font-medium">5x = 10</span>
              </div>
              <div>
                <span class="text-success">정답:</span>
                <span class="font-medium">x = 10</span>
              </div>
            </div>
          </div>
          
          <button onclick="retryProblem(5)" class="w-full py-2.5 bg-math hover:bg-math-dark text-gray-900 font-bold rounded-xl transition-colors flex items-center justify-center gap-2 text-sm">
            <span class="material-icons-round text-lg">replay</span>
            다시 풀기
          </button>
        </div>
      </div>
      
      <!-- Step Error 4 -->
      <div class="error-card bg-surface rounded-2xl shadow-lg border border-border-light overflow-hidden card-hover" data-type="step">
        <div class="bg-math-light p-3 border-b border-math/20 flex items-center justify-between">
          <div class="flex items-center gap-2">
            <span class="px-2 py-0.5 badge-step text-[10px] font-bold rounded">단계풀이</span>
            <span class="w-6 h-6 rounded-full bg-warning text-gray-900 flex items-center justify-center text-xs font-bold">!</span>
            <span class="text-xs text-text-tertiary">6일 전</span>
          </div>
          <span class="text-xs text-warning font-medium">1, 4단계 오류</span>
        </div>
        
        <div class="p-4">
          <h3 class="font-bold text-text-primary mb-1">유리수 계산</h3>
          <p class="text-xs text-text-tertiary mb-3">5단계 중 2단계에서 설명을 봤어요</p>
          
          <div class="bg-gray-50 rounded-lg p-3 mb-3">
            <p class="text-xs text-text-tertiary mb-1">문제</p>
            <div id="stepEq4" class="text-lg font-bold text-text-primary"></div>
          </div>
          
          <button onclick="retryProblem(6)" class="w-full py-2.5 bg-math hover:bg-math-dark text-gray-900 font-bold rounded-xl transition-colors flex items-center justify-center gap-2 text-sm">
            <span class="material-icons-round text-lg">replay</span>
            다시 풀기
          </button>
        </div>
      </div>
      
    </section>
    
    <!-- AI Recommendation -->
    <section class="bg-surface rounded-2xl shadow-lg border border-border-light p-5 mt-6">
      <div class="flex items-center gap-3 mb-4">
        <div class="w-10 h-10 bg-primary/10 rounded-xl flex items-center justify-center">
          <span class="material-icons-round text-primary text-xl">smart_toy</span>
        </div>
        <div>
          <h3 class="font-bold text-text-primary text-sm">AI 학습 추천</h3>
          <p class="text-xs text-text-secondary">분석 결과에 따른 맞춤 제안</p>
        </div>
      </div>
      
      <div class="space-y-2">
        <div class="flex items-start gap-2 p-3 bg-primary/5 rounded-lg">
          <span class="material-icons-round text-primary text-lg mt-0.5">tips_and_updates</span>
          <p class="text-xs text-text-secondary">
            <strong class="text-text-primary">이항 개념</strong>을 다시 복습해보세요. 
            부호가 바뀌는 이유를 이해하면 실수가 줄어들어요.
          </p>
        </div>
        <div class="flex items-start gap-2 p-3 bg-primary/5 rounded-lg">
          <span class="material-icons-round text-primary text-lg mt-0.5">auto_fix_high</span>
          <p class="text-xs text-text-secondary">
            "바로정답" 오답 후 <strong class="text-text-primary">단계별로 풀어보면</strong> 어디서 실수했는지 알 수 있어요.
          </p>
        </div>
      </div>
    </section>
    
  </main>
  
  <!-- Bottom Action Bar -->
  <div class="fixed bottom-0 left-0 right-0 bg-surface border-t border-border-light p-4 z-30">
    <div class="max-w-2xl mx-auto">
      <button onclick="startReview()" class="w-full py-3.5 bg-error hover:bg-error/90 text-white font-bold rounded-xl transition-colors flex items-center justify-center gap-2 shadow-lg shadow-error/30">
        <span class="material-icons-round">play_arrow</span>
        취약점 집중 복습 시작 (6문제)
      </button>
    </div>
  </div>
  
  <script>
    // Render KaTeX formulas
    function renderKatex(element, formula) {
      if (element && window.katex) {
        try {
          katex.render(formula, element, { displayMode: false, throwOnError: false });
        } catch (e) {
          element.textContent = formula;
        }
      }
    }
    
    function renderAllFormulas() {
      // Direct equations
      renderKatex(document.getElementById('directEq1'), '2x + 3 = x - 5');
      renderKatex(document.getElementById('directEq2'), '5(x-2) = 3x + 4');
      
      // Step equations
      renderKatex(document.getElementById('stepEq1'), '3x - 7 = 2x + 5');
      renderKatex(document.getElementById('stepEq2'), '4x - 8 = 2x + 6');
      renderKatex(document.getElementById('stepEq3'), '2(x+3) = x + 10');
      renderKatex(document.getElementById('stepEq4'), '\\frac{x}{2} + 3 = 5');
      
      // Step error details
      renderKatex(document.getElementById('step1Wrong1'), '3x + 2x - 7 = 5');
      renderKatex(document.getElementById('step1Correct1'), '3x - 2x - 7 = 5');
      renderKatex(document.getElementById('step1Wrong3'), 'x = 5 - 7');
      renderKatex(document.getElementById('step1Correct3'), 'x = 5 + 7');
    }
    
    // Filter errors by type
    function filterErrors(type) {
      // Update tabs
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.dataset.tab === type) btn.classList.add('active');
      });
      
      // Filter cards
      document.querySelectorAll('.error-card').forEach(card => {
        if (type === 'all') {
          card.style.display = 'block';
        } else {
          card.style.display = card.dataset.type === type ? 'block' : 'none';
        }
      });
    }
    
    function retryProblem(id) {
      window.location.href = `math-problem.html?retry=${id}`;
    }
    
    function startReview() {
      window.location.href = 'math-problem.html?mode=review';
    }
    
    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      setTimeout(renderAllFormulas, 100);
    });
  </script>
  <!-- MAMA-ASST Common Modules -->
  <script src="assets/js/common.js"></script>
  <script src="assets/js/modal.js"></script>
  <script src="assets/js/toast.js"></script>
  <script src="assets/js/table.js"></script>
  <script src="assets/js/chart-config.js"></script>

</body>
</html>
